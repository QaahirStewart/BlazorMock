@page "/demo/admin-panel"
@rendermode InteractiveServer

<PageTitle>Admin Panel Demo</PageTitle>

<style>
    @@keyframes fade-in {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }

    .animate-fade-in {
        animation: fade-in 0.4s ease-out;
    }

    @@keyframes slide-in {
        from {
            transform: translateX(-100%);
        }

        to {
            transform: translateX(0);
        }
    }

    .sidebar-open {
        animation: slide-in 0.3s ease-out;
    }
</style>

@if (!isAuthenticated)
{
    <!-- Login Page -->
    <div class="min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100 flex items-center justify-center p-4">
        <div class="w-full max-w-md animate-fade-in">
            <div class="bg-white rounded-2xl border-2 border-gray-200 shadow-xl p-8">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 bg-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-3xl text-white">üõ°Ô∏è</span>
                    </div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Admin Panel</h1>
                    <p class="text-gray-600">Sign in to your account</p>
                </div>

                @if (!string.IsNullOrEmpty(loginError))
                {
                    <div class="mb-4 p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm">
                        @loginError
                    </div>
                }

                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" @bind="loginEmail" @bind:after="ClearLoginError"
                            class="w-full rounded border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                            placeholder="Enter your email" />
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" @bind="loginPassword" @bind:after="ClearLoginError"
                            @onkeydown="@(e => { if (e.Key == "Enter") Login(); })"
                            class="w-full rounded border border-gray-300 p-3 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                            placeholder="Enter your password" />
                    </div>
                </div>

                <button @onclick="Login"
                    class="w-full bg-purple-600 text-white font-medium py-3 rounded hover:bg-purple-700 transition-colors mb-6">
                    Sign In
                </button>

                <div class="border-t border-gray-200 pt-6">
                    <p class="text-sm font-medium text-gray-700 mb-3">Demo Credentials:</p>
                    <div class="space-y-2 text-sm">
                        <div class="bg-purple-50 rounded p-3">
                            <p class="font-medium text-purple-900">Admin User:</p>
                            <p class="text-purple-700">admin@example.com / admin123</p>
                            <p class="text-xs text-purple-600 mt-1">Full access to all features</p>
                        </div>
                        <div class="bg-gray-50 rounded p-3">
                            <p class="font-medium text-gray-900">Regular User:</p>
                            <p class="text-gray-700">user@example.com / user123</p>
                            <p class="text-xs text-gray-600 mt-1">Limited access, view-only</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <!-- Admin Dashboard -->
    <div class="min-h-screen bg-gray-50">
        <!-- Mobile Menu Button -->
        <div class="lg:hidden fixed top-4 left-4 z-50">
            <button @onclick="ToggleSidebar" class="bg-white p-2 rounded shadow-lg border border-gray-200">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16">
                    </path>
                </svg>
            </button>
        </div>

        <!-- Sidebar -->
        <div class="@GetSidebarClass()">
            <!-- Sidebar Header -->
            <div class="p-6 border-b border-purple-700">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center">
                        <span class="text-xl text-white">üõ°Ô∏è</span>
                    </div>
                    <div>
                        <h2 class="text-lg font-bold text-white">Admin Panel</h2>
                        <p class="text-xs text-purple-200">Management System</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="flex-1 p-4 space-y-2">
                <button @onclick='() => SetView("dashboard")' class="@GetNavButtonClass("dashboard")">
                    <span class="text-lg">üìä</span>
                    <span>Dashboard</span>
                </button>
                <button @onclick='() => SetView("users")' class="@GetNavButtonClass("users")">
                    <span class="text-lg">üë•</span>
                    <span>Users</span>
                </button>
                <button @onclick='() => SetView("settings")' class="@GetNavButtonClass("settings")"
                    disabled="@(!currentUser!.IsAdmin)">
                    <span class="text-lg">‚öôÔ∏è</span>
                    <span>Settings</span>
                    @if (!currentUser!.IsAdmin)
                    {
                        <span class="ml-auto text-xs">üîí</span>
                    }
                </button>
                <button @onclick='() => SetView("audit")' class="@GetNavButtonClass("audit")"
                    disabled="@(!currentUser!.IsAdmin)">
                    <span class="text-lg">üìã</span>
                    <span>Audit Logs</span>
                    @if (!currentUser!.IsAdmin)
                    {
                        <span class="ml-auto text-xs">üîí</span>
                    }
                </button>
            </nav>

            <!-- User Profile Footer -->
            <div class="p-4 border-t border-purple-700">
                <div class="bg-purple-700 rounded p-3 mb-3">
                    <div class="flex items-center gap-3 mb-2">
                        <div
                            class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold">
                            @GetUserInitials()
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-sm font-medium text-white truncate">@currentUser!.Name</p>
                            <p class="text-xs text-purple-200 truncate">@currentUser.Email</p>
                        </div>
                    </div>
                    <div class="text-xs text-purple-200">
                        Role: <span class="font-medium text-white">@currentUser.Role</span>
                    </div>
                </div>
                <button @onclick="Logout"
                    class="w-full bg-purple-500 hover:bg-purple-400 text-white font-medium py-2 rounded transition-colors text-sm">
                    Sign Out
                </button>
            </div>
        </div>

        <!-- Overlay for mobile -->
        @if (sidebarOpen)
        {
            <div class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30" @onclick="ToggleSidebar"></div>
        }

        <!-- Main Content -->
        <div class="lg:ml-72 min-h-screen">
            <div class="p-4 sm:p-6 lg:p-8 animate-fade-in">
                @if (currentView == "dashboard")
                {
                    <DashboardView />
                }
                else if (currentView == "users")
                {
                    <UsersView />
                }
                else if (currentView == "settings")
                {
                    <SettingsView />
                }
                else if (currentView == "audit")
                {
                    <AuditView />
                }
            </div>
        </div>
    </div>
}

@code {
    // Authentication State
    private bool isAuthenticated = false;
    private string loginEmail = "";
    private string loginPassword = "";
    private string loginError = "";
    private DemoUser? currentUser = null;

    // UI State
    private string currentView = "dashboard";
    private bool sidebarOpen = false;

    // Users View State
    private string userSearchTerm = "";
    private string userRoleFilter = "";

    // Audit View State
    private string auditActionFilter = "";
    private string auditUserFilter = "";

    // Demo Users
    private List<DemoUser> demoUsers = new()
{
new DemoUser { Id = 1, Email = "admin@example.com", Password = "admin123", Name = "Admin User", Role = "Admin", IsAdmin
= true },
new DemoUser { Id = 2, Email = "user@example.com", Password = "user123", Name = "Regular User", Role = "User", IsAdmin =
false }
};

    // Sample Users Data
    private List<User> users = new()
{
new User { Id = 1, Name = "Admin User", Email = "admin@example.com", Role = "Admin", Status = "Active", LastActive = "2 min ago" },
new User { Id = 2, Name = "Regular User", Email = "user@example.com", Role = "User", Status = "Active", LastActive = "15 min ago" },
new User { Id = 3, Name = "John Smith", Email = "john.smith@example.com", Role = "User", Status = "Active", LastActive =
"1 hour ago" },
new User { Id = 4, Name = "Sarah Johnson", Email = "sarah.j@example.com", Role = "Moderator", Status = "Active",
LastActive = "3 hours ago" },
new User { Id = 5, Name = "Mike Wilson", Email = "mike.w@example.com", Role = "User", Status = "Inactive", LastActive =
"2 days ago" },
new User { Id = 6, Name = "Emily Davis", Email = "emily.d@example.com", Role = "Moderator", Status = "Active",
LastActive = "5 min ago" },
new User { Id = 7, Name = "David Brown", Email = "david.b@example.com", Role = "User", Status = "Active", LastActive =
"30 min ago" },
new User { Id = 8, Name = "Lisa Anderson", Email = "lisa.a@example.com", Role = "User", Status = "Inactive", LastActive
= "1 week ago" }
};

    // Sample Activity Data
    private List<Activity> recentActivities = new()
{
new Activity { User = "Admin User", Action = "Updated system settings", Time = "2 minutes ago", Icon = "‚öôÔ∏è" },
new Activity { User = "Sarah Johnson", Action = "Approved user registration", Time = "15 minutes ago", Icon = "‚úÖ" },
new Activity { User = "Regular User", Action = "Logged in", Time = "30 minutes ago", Icon = "üîë" },
new Activity { User = "Emily Davis", Action = "Modified user permissions", Time = "1 hour ago", Icon = "üîí" },
new Activity { User = "John Smith", Action = "Exported report", Time = "2 hours ago", Icon = "üìÑ" }
};

    // Sample Audit Logs
    private List<AuditLog> auditLogs = new()
{
new AuditLog { Id = 1, Timestamp = "2025-11-16 14:23:15", User = "Admin User", Action = "Updated system settings",
IpAddress = "192.168.1.100", Details = "Changed email notification settings" },
new AuditLog { Id = 2, Timestamp = "2025-11-16 14:15:42", User = "Sarah Johnson", Action = "User role changed",
IpAddress = "192.168.1.105", Details = "Changed Emily Davis role to Moderator" },
new AuditLog { Id = 3, Timestamp = "2025-11-16 14:08:30", User = "Admin User", Action = "User deleted", IpAddress =
"192.168.1.100", Details = "Deleted inactive user account #1234" },
new AuditLog { Id = 4, Timestamp = "2025-11-16 13:45:22", User = "Regular User", Action = "Login", IpAddress =
"192.168.1.120", Details = "Successful login" },
new AuditLog { Id = 5, Timestamp = "2025-11-16 13:30:11", User = "Emily Davis", Action = "Permission updated", IpAddress
= "192.168.1.105", Details = "Modified user access permissions" },
new AuditLog { Id = 6, Timestamp = "2025-11-16 13:15:05", User = "Admin User", Action = "Backup created", IpAddress =
"192.168.1.100", Details = "Manual database backup initiated" },
new AuditLog { Id = 7, Timestamp = "2025-11-16 12:50:33", User = "John Smith", Action = "Report generated", IpAddress =
"192.168.1.115", Details = "Generated monthly activity report" },
new AuditLog { Id = 8, Timestamp = "2025-11-16 12:30:18", User = "Sarah Johnson", Action = "User approved", IpAddress =
"192.168.1.105", Details = "Approved new user registration" }
};

    private void Login()
    {
        var user = demoUsers.FirstOrDefault(u => u.Email == loginEmail && u.Password == loginPassword);
        if (user != null)
        {
            currentUser = user;
            isAuthenticated = true;
            loginError = "";
            loginEmail = "";
            loginPassword = "";
        }
        else
        {
            loginError = "Invalid email or password. Please try again.";
        }
    }

    private void Logout()
    {
        isAuthenticated = false;
        currentUser = null;
        currentView = "dashboard";
        sidebarOpen = false;
    }

    private void ClearLoginError()
    {
        loginError = "";
    }

    private void SetView(string view)
    {
        // Check admin access for protected views
        if ((view == "settings" || view == "audit") && !currentUser!.IsAdmin)
        {
            return;
        }

        currentView = view;
        if (sidebarOpen)
        {
            sidebarOpen = false;
        }
    }

    private void ToggleSidebar()
    {
        sidebarOpen = !sidebarOpen;
    }

    private string GetSidebarClass()
    {
        var baseClass = "fixed top-0 left-0 h-full w-72 bg-purple-600 text-white flex flex-col shadow-xl transition-transform duration-300 z-40";
        if (sidebarOpen)
        {
            return baseClass + " translate-x-0 sidebar-open";
        }
        return baseClass + " -translate-x-full lg:translate-x-0";
    }

    private string GetNavButtonClass(string view)
    {
        var baseClass = "w-full flex items-center gap-3 px-4 py-3 rounded text-left transition-colors font-medium";

        var isDisabled = (view == "settings" || view == "audit") && !currentUser!.IsAdmin;
        if (isDisabled)
        {
            return baseClass + " text-purple-300 cursor-not-allowed opacity-60";
        }

        if (currentView == view)
        {
            return baseClass + " bg-purple-700 text-white";
        }
        return baseClass + " text-purple-100 hover:bg-purple-700 hover:text-white";
    }

    private string GetUserInitials()
    {
        if (currentUser == null) return "?";
        var parts = currentUser.Name.Split(' ');
        if (parts.Length >= 2)
        {
            return $"{parts[0][0]}{parts[1][0]}".ToUpper();
        }
        return currentUser.Name[0].ToString().ToUpper();
    }

    private IEnumerable<User> GetFilteredUsers()
    {
        var filtered = users.AsEnumerable();

        if (!string.IsNullOrWhiteSpace(userSearchTerm))
        {
            filtered = filtered.Where(u =>
            u.Name.Contains(userSearchTerm, StringComparison.OrdinalIgnoreCase) ||
            u.Email.Contains(userSearchTerm, StringComparison.OrdinalIgnoreCase));
        }

        if (!string.IsNullOrWhiteSpace(userRoleFilter))
        {
            filtered = filtered.Where(u => u.Role == userRoleFilter);
        }

        return filtered;
    }

    private IEnumerable<AuditLog> GetFilteredAuditLogs()
    {
        var filtered = auditLogs.AsEnumerable();

        if (!string.IsNullOrWhiteSpace(auditActionFilter))
        {
            filtered = filtered.Where(l => l.Action.Contains(auditActionFilter, StringComparison.OrdinalIgnoreCase));
        }

        if (!string.IsNullOrWhiteSpace(auditUserFilter))
        {
            filtered = filtered.Where(l => l.User == auditUserFilter);
        }

        return filtered;
    }

    // Dashboard View Component
    private RenderFragment DashboardView => __builder =>
    {
        <div>
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Dashboard</h1>
                <p class="text-gray-600">Welcome back, @currentUser!.Name</p>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                <div class="bg-white rounded-2xl border-2 border-gray-200 p-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-2xl">üë•</span>
                        <span class="text-xs font-medium text-purple-600 bg-purple-50 px-2 py-1 rounded">+12%</span>
                    </div>
                    <h3 class="text-3xl font-bold text-gray-900 mb-1">24</h3>
                    <p class="text-sm text-gray-600">Total Users</p>
                </div>
                <div class="bg-white rounded-2xl border-2 border-gray-200 p-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-2xl">üü¢</span>
                        <span class="text-xs font-medium text-green-600 bg-green-50 px-2 py-1 rounded">Active</span>
                    </div>
                    <h3 class="text-3xl font-bold text-gray-900 mb-1">8</h3>
                    <p class="text-sm text-gray-600">Active Sessions</p>
                </div>
                <div class="bg-white rounded-2xl border-2 border-gray-200 p-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-2xl">üíö</span>
                        <span class="text-xs font-medium text-green-600 bg-green-50 px-2 py-1 rounded">Healthy</span>
                    </div>
                    <h3 class="text-3xl font-bold text-gray-900 mb-1">98%</h3>
                    <p class="text-sm text-gray-600">System Health</p>
                </div>
                <div class="bg-white rounded-2xl border-2 border-gray-200 p-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-2xl">üíæ</span>
                        <span class="text-xs font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded">Normal</span>
                    </div>
                    <h3 class="text-3xl font-bold text-gray-900 mb-1">45%</h3>
                    <p class="text-sm text-gray-600">Storage Used</p>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-white rounded-2xl border-2 border-gray-200 p-6 mb-8">
                <h2 class="text-xl font-bold text-gray-900 mb-4">Recent Activity</h2>
                <div class="space-y-3">
                    @foreach (var activity in recentActivities)
                    {
                        <div class="flex items-start gap-3 p-3 rounded hover:bg-gray-50 transition-colors">
                            <span class="text-2xl">@activity.Icon</span>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-gray-900">@activity.User</p>
                                <p class="text-sm text-gray-600">@activity.Action</p>
                            </div>
                            <span class="text-xs text-gray-500 whitespace-nowrap">@activity.Time</span>
                        </div>
                    }
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="bg-white rounded-2xl border-2 border-gray-200 p-6 mb-8">
                <h2 class="text-xl font-bold text-gray-900 mb-4">Quick Actions</h2>
                <div class="flex flex-wrap gap-3">
                    <button
                        class="px-4 py-2 bg-purple-600 text-white font-medium rounded hover:bg-purple-700 transition-colors">
                        Add User
                    </button>
                    @if (currentUser!.IsAdmin)
                    {
                        <button
                            class="px-4 py-2 bg-purple-600 text-white font-medium rounded hover:bg-purple-700 transition-colors">
                            View Reports
                        </button>
                        <button
                            class="px-4 py-2 bg-purple-600 text-white font-medium rounded hover:bg-purple-700 transition-colors">
                            System Backup
                        </button>
                    }
                    else
                    {
                        <div class="px-4 py-2 bg-gray-200 text-gray-500 font-medium rounded cursor-not-allowed">
                            View Reports (Admin Only)
                        </div>
                    }
                </div>
            </div>

            <!-- Continue Learning -->
            <div class="bg-gradient-to-r from-gray-800 to-gray-900 rounded-2xl p-8 text-white">
                <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Continue Learning</h2>
                        <p class="text-gray-300">Explore the Admin Panel guide to learn how to build this</p>
                    </div>
                    <a href="/admin-guide"
                        class="px-6 py-3 bg-white text-gray-900 font-medium rounded hover:bg-gray-100 transition-colors whitespace-nowrap">
                        View Guide ‚Üí
                    </a>
                </div>
            </div>
        </div>
    };

    // Users View Component
    private RenderFragment UsersView => __builder =>
    {
        <div>
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Users</h1>
                <p class="text-gray-600">Manage user accounts and permissions</p>
            </div>

            <!-- Search and Filters -->
            <div class="bg-white rounded-2xl border-2 border-gray-200 p-4 mb-6">
                <div class="flex flex-col sm:flex-row gap-3">
                    <div class="flex-1">
                        <input type="text" @bind="userSearchTerm" @bind:event="oninput" placeholder="Search by name or email..."
                            class="w-full rounded border border-gray-300 p-2" />
                    </div>
                    <div class="sm:w-48">
                        <select @bind="userRoleFilter" class="w-full rounded border border-gray-300 p-2">
                            <option value="">All Roles</option>
                            <option value="Admin">Admin</option>
                            <option value="Moderator">Moderator</option>
                            <option value="User">User</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Access Message for Regular Users -->
            @if (!currentUser!.IsAdmin)
            {
                <div class="bg-blue-50 border border-blue-200 rounded-2xl p-4 mb-6">
                    <div class="flex items-start gap-2">
                        <span class="text-xl">‚ÑπÔ∏è</span>
                        <div>
                            <p class="text-sm font-medium text-blue-900">View Only Access</p>
                            <p class="text-sm text-blue-700">You can view user information but cannot edit or delete users. Contact
                                an admin for changes.</p>
                        </div>
                    </div>
                </div>
            }

            <!-- Users Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
                @foreach (var user in GetFilteredUsers())
                {
                    <div
                        class="bg-white rounded-2xl border-2 border-gray-200 p-6 hover:border-purple-400 hover:shadow-lg transition-all">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div
                                    class="w-12 h-12 bg-purple-600 rounded-full flex items-center justify-center text-white font-bold">
                                    @GetUserInitials(user.Name)
                                </div>
                                <div>
                                    <h3 class="font-bold text-gray-900">@user.Name</h3>
                                    <p class="text-sm text-gray-600">@user.Email</p>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center justify-between text-sm">
                                <span class="text-gray-600">Role:</span>
                                <span class="@GetRoleBadgeClass(user.Role)">@user.Role</span>
                            </div>
                            <div class="flex items-center justify-between text-sm">
                                <span class="text-gray-600">Status:</span>
                                <span class="@GetStatusBadgeClass(user.Status)">@user.Status</span>
                            </div>
                            <div class="flex items-center justify-between text-sm">
                                <span class="text-gray-600">Last Active:</span>
                                <span class="text-gray-900">@user.LastActive</span>
                            </div>
                        </div>
                        @if (currentUser!.IsAdmin)
                        {
                            <div class="flex gap-2">
                                <button
                                    class="flex-1 px-3 py-2 bg-purple-600 text-white text-sm font-medium rounded hover:bg-purple-700 transition-colors">
                                    Edit
                                </button>
                                <button
                                    class="flex-1 px-3 py-2 bg-red-600 text-white text-sm font-medium rounded hover:bg-red-700 transition-colors">
                                    Delete
                                </button>
                            </div>
                        }
                        else
                        {
                            <button disabled
                                class="w-full px-3 py-2 bg-gray-200 text-gray-500 text-sm font-medium rounded cursor-not-allowed">
                                View Only
                            </button>
                        }
                    </div>
                }
            </div>

            <!-- Continue Learning -->
            <div class="bg-gradient-to-r from-gray-800 to-gray-900 rounded-2xl p-8 text-white">
                <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Continue Learning</h2>
                        <p class="text-gray-300">Explore the Admin Panel guide to learn how to build this</p>
                    </div>
                    <a href="/admin-guide"
                        class="px-6 py-3 bg-white text-gray-900 font-medium rounded hover:bg-gray-100 transition-colors whitespace-nowrap">
                        View Guide ‚Üí
                    </a>
                </div>
            </div>
        </div>
    };

    // Settings View Component
    private RenderFragment SettingsView => __builder =>
    {
        <div>
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Settings</h1>
                <p class="text-gray-600">Configure system settings and preferences</p>
            </div>

            @if (!currentUser!.IsAdmin)
            {
                <!-- Unauthorized Message -->
                <div class="bg-white rounded-2xl border-2 border-red-200 p-12 text-center">
                    <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-4xl">üîí</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Unauthorized Access</h2>
                    <p class="text-gray-600 mb-6">Admin access is required to view and modify system settings.</p>
                    <p class="text-sm text-gray-500">Contact an administrator if you need to make changes.</p>
                </div>
            }
            else
            {
                <!-- Settings Form -->
                <div class="space-y-6 mb-8">
                    <!-- Email Configuration -->
                    <div class="bg-white rounded-2xl border-2 border-gray-200 p-6">
                        <h2 class="text-xl font-bold text-gray-900 mb-4">Email Configuration</h2>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">SMTP Server</label>
                                <input type="text" value="smtp.example.com" class="w-full rounded border border-gray-300 p-2" />
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Port</label>
                                    <input type="number" value="587" class="w-full rounded border border-gray-300 p-2" />
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Encryption</label>
                                    <select class="w-full rounded border border-gray-300 p-2">
                                        <option>TLS</option>
                                        <option>SSL</option>
                                        <option>None</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">From Address</label>
                                <input type="email" value="noreply@example.com" class="w-full rounded border border-gray-300 p-2" />
                            </div>
                        </div>
                    </div>

                    <!-- Security Settings -->
                    <div class="bg-white rounded-2xl border-2 border-gray-200 p-6">
                        <h2 class="text-xl font-bold text-gray-900 mb-4">Security Settings</h2>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                                <div>
                                    <p class="font-medium text-gray-900">Two-Factor Authentication</p>
                                    <p class="text-sm text-gray-600">Require 2FA for admin users</p>
                                </div>
                                <div class="w-12 h-6 bg-purple-600 rounded-full relative">
                                    <span class="absolute right-1 top-1 w-4 h-4 bg-white rounded-full"></span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                                <div>
                                    <p class="font-medium text-gray-900">Session Timeout</p>
                                    <p class="text-sm text-gray-600">Auto-logout after inactivity</p>
                                </div>
                                <select class="rounded border border-gray-300 p-2">
                                    <option>15 minutes</option>
                                    <option>30 minutes</option>
                                    <option selected>1 hour</option>
                                    <option>2 hours</option>
                                </select>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                                <div>
                                    <p class="font-medium text-gray-900">Password Complexity</p>
                                    <p class="text-sm text-gray-600">Enforce strong password rules</p>
                                </div>
                                <div class="w-12 h-6 bg-purple-600 rounded-full relative">
                                    <span class="absolute right-1 top-1 w-4 h-4 bg-white rounded-full"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Backup Settings -->
                    <div class="bg-white rounded-2xl border-2 border-gray-200 p-6">
                        <h2 class="text-xl font-bold text-gray-900 mb-4">Backup & Maintenance</h2>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                                <div>
                                    <p class="font-medium text-gray-900">Automatic Backups</p>
                                    <p class="text-sm text-gray-600">Daily system backups at 2:00 AM</p>
                                </div>
                                <div class="w-12 h-6 bg-purple-600 rounded-full relative">
                                    <span class="absolute right-1 top-1 w-4 h-4 bg-white rounded-full"></span>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Retention Period</label>
                                <select class="w-full rounded border border-gray-300 p-2">
                                    <option>7 days</option>
                                    <option>14 days</option>
                                    <option selected>30 days</option>
                                    <option>90 days</option>
                                </select>
                            </div>
                            <button
                                class="w-full sm:w-auto px-6 py-2 bg-purple-600 text-white font-medium rounded hover:bg-purple-700 transition-colors">
                                Backup Now
                            </button>
                        </div>
                    </div>

                    <!-- Save Button -->
                    <div class="flex justify-end">
                        <button
                            class="px-8 py-3 bg-purple-600 text-white font-medium rounded hover:bg-purple-700 transition-colors">
                            Save All Settings
                        </button>
                    </div>
                </div>
            }

            <!-- Continue Learning -->
            <div class="bg-gradient-to-r from-gray-800 to-gray-900 rounded-2xl p-8 text-white">
                <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Continue Learning</h2>
                        <p class="text-gray-300">Explore the Admin Panel guide to learn how to build this</p>
                    </div>
                    <a href="/admin-guide"
                        class="px-6 py-3 bg-white text-gray-900 font-medium rounded hover:bg-gray-100 transition-colors whitespace-nowrap">
                        View Guide ‚Üí
                    </a>
                </div>
            </div>
        </div>
    };

    // Audit View Component
    private RenderFragment AuditView => __builder =>
    {
        <div>
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Audit Logs</h1>
                <p class="text-gray-600">Track system activities and user actions</p>
            </div>

            @if (!currentUser!.IsAdmin)
            {
                <!-- Unauthorized Message -->
                <div class="bg-white rounded-2xl border-2 border-red-200 p-12 text-center">
                    <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-4xl">üîí</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Unauthorized Access</h2>
                    <p class="text-gray-600 mb-6">Admin access is required to view audit logs.</p>
                    <p class="text-sm text-gray-500">Contact an administrator if you need access to system logs.</p>
                </div>
            }
            else
            {
                <!-- Filters -->
                <div class="bg-white rounded-2xl border-2 border-gray-200 p-4 mb-6">
                    <div class="flex flex-col sm:flex-row gap-3">
                        <div class="flex-1">
                            <input type="text" @bind="auditActionFilter" @bind:event="oninput" placeholder="Filter by action..."
                                class="w-full rounded border border-gray-300 p-2" />
                        </div>
                        <div class="sm:w-48">
                            <select @bind="auditUserFilter" class="w-full rounded border border-gray-300 p-2">
                                <option value="">All Users</option>
                                <option value="Admin User">Admin User</option>
                                <option value="Regular User">Regular User</option>
                                <option value="Sarah Johnson">Sarah Johnson</option>
                                <option value="Emily Davis">Emily Davis</option>
                                <option value="John Smith">John Smith</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Audit Logs Table -->
                <div class="bg-white rounded-2xl border-2 border-gray-200 overflow-hidden mb-8">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Timestamp</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Action</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">IP
                                        Address</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Details</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                @foreach (var log in GetFilteredAuditLogs())
                                {
                                    <tr class="hover:bg-gray-50 transition-colors">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">@log.Timestamp</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">@log.User</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="@GetActionBadgeClass(log.Action)">@log.Action</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono">@log.IpAddress</td>
                                        <td class="px-6 py-4 text-sm text-gray-600">@log.Details</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Export Button -->
                <div class="flex justify-end mb-8">
                    <button class="px-6 py-2 bg-purple-600 text-white font-medium rounded hover:bg-purple-700 transition-colors">
                        Export Logs
                    </button>
                </div>
            }

            <!-- Continue Learning -->
            <div class="bg-gradient-to-r from-gray-800 to-gray-900 rounded-2xl p-8 text-white">
                <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Continue Learning</h2>
                        <p class="text-gray-300">Explore the Admin Panel guide to learn how to build this</p>
                    </div>
                    <a href="/admin-guide"
                        class="px-6 py-3 bg-white text-gray-900 font-medium rounded hover:bg-gray-100 transition-colors whitespace-nowrap">
                        View Guide ‚Üí
                    </a>
                </div>
            </div>
        </div>
    };

    private string GetUserInitials(string name)
    {
        var parts = name.Split(' ');
        if (parts.Length >= 2)
        {
            return $"{parts[0][0]}{parts[1][0]}".ToUpper();
        }
        return name[0].ToString().ToUpper();
    }

    private string GetRoleBadgeClass(string role)
    {
        return role switch
        {
            "Admin" => "px-2 py-1 bg-purple-100 text-purple-700 text-xs font-medium rounded",
            "Moderator" => "px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",
            _ => "px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded"
        };
    }

    private string GetStatusBadgeClass(string status)
    {
        return status == "Active"
                    ? "px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded"
                    : "px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded";
    }

    private string GetActionBadgeClass(string action)
    {
        if (action.Contains("delete", StringComparison.OrdinalIgnoreCase))
            return "px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded";
        if (action.Contains("update", StringComparison.OrdinalIgnoreCase) || action.Contains("changed",
        StringComparison.OrdinalIgnoreCase))
            return "px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded";
        if (action.Contains("login", StringComparison.OrdinalIgnoreCase))
            return "px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded";
        return "px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded";
    }

    // Models
    private class DemoUser
    {
        public int Id { get; set; }
        public string Email { get; set; } = "";
        public string Password { get; set; } = "";
        public string Name { get; set; } = "";
        public string Role { get; set; } = "";
        public bool IsAdmin { get; set; }
    }

    private class User
    {
        public int Id { get; set; }
        public string Name { get; set; } = "";
        public string Email { get; set; } = "";
        public string Role { get; set; } = "";
        public string Status { get; set; } = "";
        public string LastActive { get; set; } = "";
    }

    private class Activity
    {
        public string User { get; set; } = "";
        public string Action { get; set; } = "";
        public string Time { get; set; } = "";
        public string Icon { get; set; } = "";
    }

    private class AuditLog
    {
        public int Id { get; set; }
        public string Timestamp { get; set; } = "";
        public string User { get; set; } = "";
        public string Action { get; set; } = "";
        public string IpAddress { get; set; } = "";
        public string Details { get; set; } = "";
    }
}