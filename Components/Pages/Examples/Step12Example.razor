@page "/examples/step12"
@inject ILearningProgressService ProgressService
@rendermode InteractiveServer
@* JS copy removed; using global code enhancer per-block *@

<PageTitle>Step 12: Pay & Expense Calculation - Example</PageTitle>

<div class="min-h-screen py-8 rounded-4xl bg-gray-50">
    <div class="w-full mx-auto px-4 max-w-5xl">
        <div class="mb-8">
            <a href="/guide" class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-700 mb-4">
                <span>‚Üê</span> Back to Guide
            </a>
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4">
                <div class="min-w-0 flex-1">
                    <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-2 break-words">üéØ Step 12: Pay & Expense
                        Calculation</h1>
                    <p class="text-base sm:text-lg md:text-xl text-gray-600 leading-relaxed break-words">Build a service
                        to calculate driver pay and route expenses.</p>
                </div>

            </div>
        </div>

        <div class="bg-white rounded-xl p-6 border border-gray-200 mb-6">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 break-words">
                üéØ Learning Objectives
            </h2>
            <ul class="space-y-2 text-sm sm:text-base lg:text-lg text-gray-700">
                <li class="flex items-start gap-2">
                    <span class="text-green-500 flex-shrink-0 mt-1">‚úì</span>
                    <span class="break-words min-w-0">Create a service for business calculations</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-500 flex-shrink-0 mt-1">‚úì</span>
                    <span class="break-words min-w-0">Calculate driver pay based on multiple factors</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-500 flex-shrink-0 mt-1">‚úì</span>
                    <span class="break-words min-w-0">Estimate route costs and fuel expenses</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-500 flex-shrink-0 mt-1">‚úì</span>
                    <span class="break-words min-w-0">Calculate profitability and margins</span>
                </li>
            </ul>
        </div>

        <div class="bg-white rounded-xl p-6 border border-gray-200 mb-6">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 break-words">
                üèóÔ∏è Create ScheduleService
            </h2>
            <p class="text-sm sm:text-base text-gray-700 mb-3">A dedicated service keeps all pay and expense formulas in
                one place so they‚Äôre easy to reuse and test. Each method focuses on a single concern: driver pay, fuel
                cost, total route cost, and profit margin.</p>
            <ul class="list-disc ml-5 text-xs sm:text-sm text-gray-700 mb-4 space-y-1">
                <li>Centralize business logic for reuse across pages</li>
                <li>Keep constants (like fuel price) in one spot</li>
                <li>Small methods make unit testing straightforward</li>
            </ul>

            <h3 class="text-lg sm:text-xl font-semibold text-gray-900 mb-2">üß© Code Example: ScheduleService</h3>
            <div class="bg-gray-100 rounded-lg p-4 overflow-x-auto break-all mb-4">
                <pre data-code-title="C# (Services/ScheduleService.cs)">
// Services/ScheduleService.cs
namespace BlazorMock.Services;

/// &lt;summary&gt;
/// Service for calculating driver pay and route expenses.
/// Centralizes all financial calculations for the trucking app.
/// &lt;/summary&gt;
public class ScheduleService
{
    // Constants for calculations
    private const decimal FuelPricePerGallon = 3.85m;
    private const double AverageMpg = 6.5; // Miles per gallon for trucks
    private const decimal HazmatBonus = 250m;
    private const decimal OversizedBonus = 300m;
    private const decimal LongHaulBonusPerMile = 0.15m;

    /// &lt;summary&gt;
    /// Calculates total driver pay for a route.
    /// Includes base pay, experience multiplier, and route type bonuses.
    /// &lt;/summary&gt;
    public decimal CalculateDriverPay(Route route, Driver driver)
    {
        // Calculate estimated drive time in hours
        double driveTime = route.GetEstimatedDriveTime();
        
        // Base pay = hourly rate * drive time
        decimal basePay = driver.HourlyRate * (decimal)driveTime;

        // Experience multiplier (1% bonus per year, max 25%)
        decimal experienceMultiplier = 1.0m + Math.Min(driver.YearsOfExperience * 0.01m, 0.25m);
        decimal payWithExperience = basePay * experienceMultiplier;

        // Route type bonuses
        decimal routeBonus = route.Type switch
        {
            RouteType.Hazmat =&gt; HazmatBonus,
            RouteType.Oversized =&gt; OversizedBonus,
            RouteType.LongHaul =&gt; route.DistanceMiles * LongHaulBonusPerMile,
            _ =&gt; 0m
        };

        return payWithExperience + routeBonus;
    }

    /// &lt;summary&gt;
    /// Estimates fuel cost for a route based on distance.
    /// &lt;/summary&gt;
    public decimal EstimateFuelCost(int distanceMiles)
    {
        double gallonsNeeded = distanceMiles / AverageMpg;
        return (decimal)gallonsNeeded * FuelPricePerGallon;
    }

    /// &lt;summary&gt;
    /// Calculates total route cost including driver pay and fuel.
    /// &lt;/summary&gt;
    public decimal CalculateTotalRouteCost(Route route, Driver driver)
    {
        decimal driverPay = CalculateDriverPay(route, driver);
        decimal fuelCost = EstimateFuelCost(route.DistanceMiles);
        
        // Add other estimated costs (maintenance, tolls, etc.)
        decimal otherCosts = route.DistanceMiles * 0.10m; // $0.10 per mile

        return driverPay + fuelCost + otherCosts;
    }

    /// &lt;summary&gt;
    /// Suggests minimum revenue needed for profitability.
    /// Adds 20% profit margin to total costs.
    /// &lt;/summary&gt;
    public decimal SuggestMinimumRevenue(Route route, Driver driver)
    {
        decimal totalCost = CalculateTotalRouteCost(route, driver);
        return totalCost * 1.20m; // 20% profit margin
    }

    /// &lt;summary&gt;
    /// Calculates profit margin percentage for a route.
    /// &lt;/summary&gt;
    public decimal CalculateProfitMargin(Route route, Driver driver)
    {
        decimal totalCost = CalculateTotalRouteCost(route, driver);
        if (route.Revenue == 0) return 0;

        decimal profit = route.Revenue - totalCost;
        return (profit / route.Revenue) * 100;
    }
}
                </pre>
            </div>

            <div class="bg-blue-50 border-l-4 border-blue-500 p-4">
                <p class="text-sm sm:text-base text-blue-800 break-words">
                    <strong>üí° Pro Tip:</strong> Keep all business calculations in a service so they're reusable and
                    testable!
                </p>
            </div>
        </div>

        <div class="bg-white rounded-xl p-6 border border-gray-200 mb-6">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 break-words">
                üîß Register Service in Program.cs
            </h2>
            <p class="text-sm sm:text-base text-gray-700 mb-3">Register the calculation service with dependency
                injection so pages and components can request it as needed. Scoped lifetime works well for Blazor Server
                user sessions.</p>
            <ul class="list-disc ml-5 text-xs sm:text-sm text-gray-700 mb-4 space-y-1">
                <li>Use DI to avoid manual service creation</li>
                <li>Scoped lifetime: one instance per connected user</li>
                <li>Keep Program.cs focused on registrations and middleware</li>
            </ul>

            <h3 class="text-lg sm:text-xl font-semibold text-gray-900 mb-2">üß© Code Example: Program.cs registration</h3>
            <div class="bg-gray-100 rounded-lg p-4 overflow-x-auto break-all mb-4">
                <pre data-code-title="Program.cs registration">
// Program.cs
using BlazorMock.Services;

var builder = WebApplication.CreateBuilder(args);

// Register ScheduleService as Scoped
// Scoped = one instance per user session/circuit
builder.Services.AddScoped&lt;ScheduleService&gt;();

var app = builder.Build();
                </pre>
            </div>
        </div>

        <div class="bg-white rounded-xl p-6 border border-gray-200 mb-6">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 break-words">
                üìù Use Service in Components
            </h2>
            <p class="text-sm sm:text-base text-gray-700 mb-3">Call the service methods inside a page or component to
                show real-time estimates (driver pay, fuel, total cost) and to validate profitability before saving a
                route.</p>
            <ul class="list-disc ml-5 text-xs sm:text-sm text-gray-700 mb-4 space-y-1">
                <li>Display estimates to help users make decisions</li>
                <li>Recalculate on user input with simple event handlers</li>
                <li>Save the computed values alongside the route</li>
            </ul>

            <h3 class="text-lg sm:text-xl font-semibold text-gray-900 mb-2">üß© Code Example: Use Service in Page</h3>
            <div class="bg-gray-100 rounded-lg p-4 overflow-x-auto break-all mb-4">
                <pre data-code-title="Razor + C# (Use Service in Page)">
@@page "/routes/create"
@@inject ScheduleService ScheduleService
@@inject AppDbContext DbContext

&lt;h1&gt;Create New Route&lt;/h1&gt;

&lt;EditForm Model="newRoute" OnValidSubmit="HandleValidSubmit"&gt;
    &lt;!-- Form fields for route, driver, truck selection --&gt;

    &lt;!-- Display calculated values --&gt;
    @@if (selectedDriver != null)
    {
        &lt;div class="calculations-panel"&gt;
            &lt;h3&gt;Estimated Costs&lt;/h3&gt;
            
            &lt;div class="calculation-row"&gt;
                &lt;span&gt;Driver Pay:&lt;/span&gt;
                &lt;span&gt;$@@estimatedDriverPay.ToString("N2")&lt;/span&gt;
            &lt;/div&gt;

            &lt;div class="calculation-row"&gt;
                &lt;span&gt;Fuel Cost:&lt;/span&gt;
                &lt;span&gt;$@@estimatedFuelCost.ToString("N2")&lt;/span&gt;
            &lt;/div&gt;

            &lt;div class="calculation-row"&gt;
                &lt;span&gt;Total Cost:&lt;/span&gt;
                &lt;span&gt;$@@totalCost.ToString("N2")&lt;/span&gt;
            &lt;/div&gt;

            &lt;div class="calculation-row highlight"&gt;
                &lt;span&gt;Suggested Revenue:&lt;/span&gt;
                &lt;span&gt;$@@suggestedRevenue.ToString("N2")&lt;/span&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="form-group"&gt;
            &lt;label&gt;Actual Revenue:&lt;/label&gt;
            &lt;InputNumber @@bind-Value="newRoute.Revenue" 
                         @@bind-Value:after="CalculateProfit" /&gt;
        &lt;/div&gt;

        @@if (profitMargin != 0)
        {
            &lt;div class="profit-display @@GetProfitClass()"&gt;
                Profit Margin: @@profitMargin.ToString("N2")%
            &lt;/div&gt;
        }
    }

    &lt;button type="submit"&gt;Create Route&lt;/button&gt;
&lt;/EditForm&gt;

@@code {
    private Route newRoute = new();
    private Driver? selectedDriver;
    
    private decimal estimatedDriverPay;
    private decimal estimatedFuelCost;
    private decimal totalCost;
    private decimal suggestedRevenue;
    private decimal profitMargin;

    private async Task OnDriverOrDistanceChanged()
    {
        if (newRoute.DriverId &gt; 0 && newRoute.DistanceMiles &gt; 0)
        {
            selectedDriver = await DbContext.Drivers.FindAsync(newRoute.DriverId);
            
            if (selectedDriver != null)
            {
                // Calculate all values using the service
                estimatedDriverPay = ScheduleService.CalculateDriverPay(newRoute, selectedDriver);
                estimatedFuelCost = ScheduleService.EstimateFuelCost(newRoute.DistanceMiles);
                totalCost = ScheduleService.CalculateTotalRouteCost(newRoute, selectedDriver);
                suggestedRevenue = ScheduleService.SuggestMinimumRevenue(newRoute, selectedDriver);
            }
        }
    }

    private void CalculateProfit()
    {
        if (selectedDriver != null && newRoute.Revenue &gt; 0)
        {
            profitMargin = ScheduleService.CalculateProfitMargin(newRoute, selectedDriver);
        }
    }

    private string GetProfitClass()
    {
        return profitMargin switch
        {
            &gt;= 20 =&gt; "profit-good",     // Green
            &gt;= 10 =&gt; "profit-ok",       // Yellow
            _ =&gt; "profit-bad"            // Red
        };
    }

    private async Task HandleValidSubmit()
    {
        // Save calculated values to the route
        newRoute.DriverPay = estimatedDriverPay;
        newRoute.EstimatedFuelCost = estimatedFuelCost;

        DbContext.Routes.Add(newRoute);
        await DbContext.SaveChangesAsync();
        
        Navigation.NavigateTo("/routes");
    }
}
                </pre>
            </div>
        </div>

        <!-- Live Demo: Pay & Expense Calculation -->
        <div class="bg-black/3 rounded-2xl p-6 border border-gray-200 mb-6">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 break-words">üé¨ Live Demo: Pay & Expense</h2>

            <div class="bg-white rounded-xl p-4 border border-gray-200">
                <!-- Controls -->
                <div class="grid sm:grid-cols-3 gap-3 mb-4">
                    <div>
                        <label class="block text-xs text-gray-600 mb-1">Base Rate per Mile</label>
                        <InputNumber @bind-Value="s12BaseRatePerMile" step="0.01"
                            class="w-full rounded border border-gray-300 p-2" />
                    </div>
                    <div>
                        <label class="block text-xs text-gray-600 mb-1">Overtime Rate (per hour)</label>
                        <InputNumber @bind-Value="s12OvertimeRatePerHour" step="1"
                            class="w-full rounded border border-gray-300 p-2" />
                    </div>
                    <div class="flex items-end gap-2">
                        <button class="px-3 py-1.5 rounded bg-blue-600 hover:bg-blue-700 text-white text-xs sm:text-sm"
                            @onclick="ApplyS12GlobalRates">Apply Rates</button>
                        <button class="px-3 py-1.5 rounded border border-gray-300 hover:bg-gray-50 text-xs sm:text-sm"
                            @onclick="ResetS12">Reset Sample</button>
                    </div>
                </div>

                <!-- KPIs -->
                <div class="grid sm:grid-cols-4 gap-3 mb-4">
                    <div class="rounded border p-3">
                        <div class="text-xs text-gray-500">Total Miles</div>
                        <div class="text-xl font-semibold">@s12Totals.TotalMiles</div>
                    </div>
                    <div class="rounded border p-3">
                        <div class="text-xs text-gray-500">Total Pay</div>
                        <div class="text-xl font-semibold">@s12Totals.TotalPay.ToString("C")</div>
                    </div>
                    <div class="rounded border p-3">
                        <div class="text-xs text-gray-500">Total Expenses</div>
                        <div class="text-xl font-semibold">@s12Totals.TotalExpenses.ToString("C")</div>
                    </div>
                    <div class="rounded border p-3">
                        <div class="text-xs text-gray-500">Avg Cost / Mile</div>
                        <div class="text-xl font-semibold">@(s12Totals.TotalMiles == 0 ? "-" : (s12Totals.TotalExpenses
                                                        / s12Totals.TotalMiles).ToString("C"))</div>
                    </div>
                </div>

                <!-- Driver comparison bars -->
                <div class="space-y-3">
                    @foreach (var row in s12DriverSummaries)
                    {
                        var total = row.Pay + row.Expenses;
                        var payPct = total == 0 ? 0 : (row.Pay / total) * 100m;
                        var expPct = 100m - payPct;
                        <div class="space-y-1">
                            <div class="flex items-center justify-between text-xs sm:text-sm">
                                <div class="font-medium">@row.Driver</div>
                                <div class="text-gray-600">Pay @row.Pay.ToString("C") ¬∑ Exp @row.Expenses.ToString("C")
                                </div>
                            </div>
                            <div class="h-3 w-full rounded bg-gray-200 overflow-hidden">
                                <div class="h-full bg-green-500" style="width:@payPct%"></div>
                                <div class="h-full bg-amber-500 -mt-3" style="width:@expPct%"></div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>

        <div class="bg-white rounded-xl p-6 border border-gray-200 mb-6">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 break-words">
                üìä Calculation Breakdown
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-lg">
                    <h3 class="font-semibold text-green-900 mb-2 text-sm sm:text-base">Driver Pay Formula</h3>
                    <div class="text-xs sm:text-sm text-green-800 space-y-1 font-mono">
                        <div>Base = Rate √ó Hours</div>
                        <div>Bonus = Experience √ó 1%</div>
                        <div>Special = Route Type Bonus</div>
                        <div class="font-bold pt-2">Total = Base + Bonus + Special</div>
                    </div>
                </div>

                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-900 mb-2 text-sm sm:text-base">Total Cost Formula</h3>
                    <div class="text-xs sm:text-sm text-blue-800 space-y-1 font-mono">
                        <div>Driver Pay</div>
                        <div>+ Fuel Cost</div>
                        <div>+ Maintenance ($0.10/mi)</div>
                        <div class="font-bold pt-2">= Total Route Cost</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-xl p-6 border border-gray-200 mb-6">
            <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 break-words">
                üîë Key Takeaways
            </h2>
            <ul class="space-y-3 text-sm sm:text-base lg:text-lg text-gray-700">
                <li class="flex items-start gap-2">
                    <span class="text-green-500 flex-shrink-0 mt-1">‚úì</span>
                    <span class="break-words min-w-0">Create services for complex business logic</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-500 flex-shrink-0 mt-1">‚úì</span>
                    <span class="break-words min-w-0">Use constants for values that may change</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-500 flex-shrink-0 mt-1">‚úì</span>
                    <span class="break-words min-w-0">Calculate values before saving to database</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-500 flex-shrink-0 mt-1">‚úì</span>
                    <span class="break-words min-w-0">Show real-time calculations to users</span>
                </li>
                <li class="flex items-start gap-2">
                    <span class="text-green-500 flex-shrink-0 mt-1">‚úì</span>
                    <span class="break-words min-w-0">Use switch expressions for type-based logic</span>
                </li>
            </ul>
        </div>

        <div class="bg-white rounded-xl p-6 border-2 border-green-200">
            <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                <div class="min-w-0 flex-1">
                    <h3 class="text-lg sm:text-xl font-bold text-gray-900 mb-2 break-words">Ready to move on?</h3>
                    <p class="text-sm sm:text-base text-gray-600 break-words">Mark this step as complete to track your
                        progress!</p>
                </div>
                @if (isComplete)
                {
                    <div class="flex items-center gap-3">
                        <span class="px-4 py-2 rounded-full bg-green-100 text-green-700 font-medium">‚úì Completed</span>
                        <button @onclick="@(async () => await ProgressService.MarkStepIncompleteAsync(12))"
                            class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm">Reset</button>
                    </div>
                }
                else
                {
                    <button @onclick="MarkComplete"
                        class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors">Mark
                        as Complete</button>
                }
            </div>
        </div>

        <!-- Navigation -->
        <div class="mt-8 flex items-center justify-between">
            <a href="/examples/step11" class="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                <span>‚Üê</span>
                Previous: Step 11
            </a>
            <a href="/examples/step13" class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                Next: Step 13
                <span>‚Üí</span>
            </a>
        </div>
    </div>
</div>

@code {
    private bool isComplete = false;
    private IJSObjectReference? _copyModule;

    // --- Live Demo (Step 12) State ---
    private decimal s12BaseRatePerMile = 0.65m;
    private decimal s12OvertimeRatePerHour = 30m;
    private List<DemoTrip> s12Trips = new();
    private Step12Totals s12Totals = new();
    private List<Step12DriverSummary> s12DriverSummaries = new();

    protected override async Task OnInitializedAsync()
    {
        var step = await ProgressService.GetStepAsync(12);
        isComplete = step?.IsComplete ?? false;
        InitializeS12Trips();
        RecomputeS12();
    }

    private async Task MarkComplete()
    {
        await ProgressService.MarkStepCompleteAsync(12);
        isComplete = true;
    }

    // --- Live Demo (Step 12) Logic ---
    private void InitializeS12Trips()
    {
        s12Trips = new()
{
new DemoTrip { Driver = "Alex", Miles = 420, RatePerMile = s12BaseRatePerMile, PerDiem = 35m, OvertimeHours = 1m,
OvertimeRatePerHour = s12OvertimeRatePerHour, FuelCost = 160m },
new DemoTrip { Driver = "Alex", Miles = 310, RatePerMile = s12BaseRatePerMile, PerDiem = 35m, OvertimeHours = 0m,
OvertimeRatePerHour = s12OvertimeRatePerHour, FuelCost = 120m },
new DemoTrip { Driver = "Sam", Miles = 520, RatePerMile = s12BaseRatePerMile, PerDiem = 45m, OvertimeHours = 2m,
OvertimeRatePerHour = s12OvertimeRatePerHour, FuelCost = 210m },
new DemoTrip { Driver = "Sam", Miles = 290, RatePerMile = s12BaseRatePerMile, PerDiem = 35m, OvertimeHours = 0m,
OvertimeRatePerHour = s12OvertimeRatePerHour, FuelCost = 115m },
};
    }

    private void ResetS12()
    {
        InitializeS12Trips();
        RecomputeS12();
    }

    private void ApplyS12GlobalRates()
    {
        foreach (var t in s12Trips)
        {
            t.RatePerMile = s12BaseRatePerMile;
            t.OvertimeRatePerHour = s12OvertimeRatePerHour;
        }
        RecomputeS12();
    }

    private decimal ComputeS12Pay(DemoTrip t)
    => (t.Miles * t.RatePerMile) + (t.OvertimeHours * t.OvertimeRatePerHour) + t.PerDiem;

    private void RecomputeS12()
    {
        s12Totals = new Step12Totals
        {
            TotalMiles = s12Trips.Sum(x => x.Miles),
            TotalPay = s12Trips.Sum(ComputeS12Pay),
            TotalExpenses = s12Trips.Sum(x => x.FuelCost)
        };

        s12DriverSummaries = s12Trips
        .GroupBy(t => t.Driver)
        .Select(g => new Step12DriverSummary
        {
            Driver = g.Key,
            Pay = g.Sum(ComputeS12Pay),
            Expenses = g.Sum(x => x.FuelCost)
        })
        .OrderByDescending(x => x.Pay)
        .ToList();
    }

    // Demo types (local to this page)
    public class DemoTrip
    {
        public string Driver { get; set; } = string.Empty;
        public int Miles { get; set; }
        public decimal RatePerMile { get; set; }
        public decimal PerDiem { get; set; }
        public decimal OvertimeHours { get; set; }
        public decimal OvertimeRatePerHour { get; set; }
        public decimal FuelCost { get; set; }
    }

    public class Step12Totals
    {
        public int TotalMiles { get; set; }
        public decimal TotalPay { get; set; }
        public decimal TotalExpenses { get; set; }
    }

    public class Step12DriverSummary
    {
        public string Driver { get; set; } = string.Empty;
        public decimal Pay { get; set; }
        public decimal Expenses { get; set; }
    }

    // No JS module to dispose; using global code enhancer per-block
}