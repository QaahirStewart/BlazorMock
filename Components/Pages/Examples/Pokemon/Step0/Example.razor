@page "/pokemon-examples/step0"
@rendermode InteractiveServer
@inherits ExampleBase

<PageTitle>Pokemon Step 0: Configure HttpClient for PokeAPI</PageTitle>

<div class="min-h-screen py-8">
    <div class="w-full mx-auto px-4 max-w-5xl">
        <a href="/pokemon-guide" class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-700 mb-4">
            <span>‚Üê</span> Back to Pokemon guide
        </a>

        <div class="rounded-2xl overflow-hidden border border-gray-200 bg-white mb-6">
            <div class="h-2 w-full bg-gradient-to-r from-yellow-200 via-yellow-300 to-yellow-400"></div>
            <div class="p-5 sm:p-6">
                <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-2">
                    üéÆ Pokemon Step 0: Configure HttpClient for PokeAPI
                </h1>
                <p class="text-gray-600">
                    Set up a dedicated HttpClient for the PokeAPI so you can call it from your components.
                </p>
            </div>
        </div>

        <div class="bg-gradient-to-r from-gray-100 to-blue-100 rounded-2xl p-5 sm:p-6 mb-6">
            <h2 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-4">What you'll do</h2>
            <p class="text-gray-700 mb-4 text-sm sm:text-base">
                You'll register a named HttpClient for the PokeAPI so later Pokemon examples can safely reuse it from
                any
                component without duplicating configuration.
            </p>
            <ul class="list-disc ml-6 text-sm sm:text-base text-gray-700 space-y-2 mb-4">
                <li>Define a named HttpClient configured for <span class="font-mono">https://pokeapi.co/api/v2/</span>.
                </li>
                <li>Register it in <span class="font-mono">Program.cs</span> using <code>AddHttpClient</code> so it's
                    available via DI.</li>
                <li>Inject the factory into a Razor component and create the named <code>PokeApi</code> client for a
                    test call.</li>
            </ul>
            <div class="mt-2 pt-3 border-t border-blue-200 mb-4">
                <p class="text-xs sm:text-sm text-gray-700 mb-2"><strong>üí° Key Concepts:</strong>
                    <code>AddHttpClient</code>, base addresses, dependency injection, named clients
                </p>
                <div class="flex flex-wrap items-center gap-2">
                    <span class="text-xs sm:text-sm text-gray-600">‚Üí Related tips:</span>
                    <a href="/tips#ihttpclientfactory"
                        class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-[11px] sm:text-xs font-medium hover:bg-blue-200 transition-colors">IHttpClientFactory</a>
                    <a href="/tips#dependency-injection-di"
                        class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-[11px] sm:text-xs font-medium hover:bg-blue-200 transition-colors">Dependency Injection</a>
                </div>
            </div>
            <div class="grid gap-3">
                <div class="bg-gray-100 border border-gray-200 rounded-lg p-4">
                    <div class="flex items-baseline justify-between mb-1">
                        <div class="text-xs text-gray-500">Program.cs registration</div>
                        <div class="text-[10px] text-gray-400 font-mono">Program.cs</div>
                    </div>
                    <p class="text-xs text-gray-600 mb-2">Registers a reusable named HttpClient called
                        <code>PokeApi</code> that always
                        points at the PokeAPI base URL.</p>
                    <ul class="list-disc ml-4 mb-2 text-[11px] text-gray-600 space-y-1">
                        <li>Uses <code>AddHttpClient</code> to create a DI-managed client.</li>
                        <li>Sets <code>BaseAddress</code> so later requests only pass relative paths.</li>
                    </ul>
                    <pre class="code-block text-xs sm:text-sm font-mono text-gray-800 w-full max-w-full overflow-x-auto"
                        data-code-title="Program.cs ‚Äì PokeApi client registration">builder.Services.AddHttpClient("PokeApi", client =&gt;
{
    client.BaseAddress = new Uri("https://pokeapi.co/api/v2/");
});</pre>
                </div>
                <div class="bg-gray-100 border border-gray-200 rounded-lg p-4">
                    <div class="flex items-baseline justify-between mb-1">
                        <div class="text-xs text-gray-500">Razor injection example</div>
                        <div class="text-[10px] text-gray-400 font-mono">Example.razor</div>
                    </div>
                    <p class="text-xs text-gray-600 mb-2">Shows how to inject the factory into a component
                        and create the named <code>PokeApi</code> client for later API calls.</p>
                    <ul class="list-disc ml-4 mb-2 text-[11px] text-gray-600 space-y-1">
                        <li><code>@@inject IHttpClientFactory</code> pulls the factory from DI.</li>
                        <li><code>CreateClient("PokeApi")</code> returns a correctly configured HttpClient instance.
                        </li>
                    </ul>
                    <pre class="code-block text-xs sm:text-sm font-mono text-gray-800 w-full max-w-full overflow-x-auto"
                        data-code-title="Example.razor ‚Äì using the PokeApi client">@@inject IHttpClientFactory HttpClientFactory

@@code {
    protected override async Task OnInitializedAsync()
    {
        var client = HttpClientFactory.CreateClient("PokeApi");
        // TODO: test call here
    }
}</pre>
                </div>
            </div>
            <p class="text-xs sm:text-sm text-gray-600 mt-4">Once this is working, later steps can focus on calling the
                API and
                rendering Pokemon instead of wiring up HttpClient.</p>
        </div>

        <div class="bg-gradient-to-r from-gray-100 to-blue-100 rounded-2xl p-5 sm:p-6 mb-6">
            <h2 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-4">üõ†Ô∏è How to do it</h2>
            <ol class="list-decimal ml-5 space-y-2 text-gray-700 text-sm sm:text-base">
                <li>
                    <strong>Register the client:</strong>
                    Add the <code>builder.Services.AddHttpClient("PokeApi", ...)</code> snippet to
                    <code>Program.cs</code>.
                </li>
                <li>
                    <strong>Inject and test:</strong>
                    Use <code>@@inject IHttpClientFactory</code> in a Razor component and call
                    <code>CreateClient("PokeApi")</code>.
                </li>
                <li>
                    <strong>Verify it works:</strong>
                    Run the app and confirm you can make a simple test call without errors.
                </li>
            </ol>
        </div>

        <div class="bg-white rounded-xl p-6 border-2 border-green-200 mb-6">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-1">Finished Pokemon Step 0?</h3>
                    <p class="text-sm text-gray-600">Mark it complete to track your Pokemon progress.</p>
                </div>
                @if (isComplete)
                {
                    <div class="flex items-center gap-3">
                        <span class="px-4 py-2 rounded-full bg-green-100 text-green-700 font-medium">‚úì Completed</span>
                        <button @onclick="ResetStep"
                            class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm">Reset</button>
                    </div>
                }
                else
                {
                    <button @onclick="MarkComplete"
                        class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors">Mark
                        as Complete</button>
                }
            </div>
        </div>

        <div class="flex items-center justify-between">
            <a href="/pokemon-guide"
                class="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                <span>‚Üê</span>
                Back to Pokemon guide
            </a>
            <a href="/pokemon-examples/step1"
                class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                Next: Step 1
                <span>‚Üí</span>
            </a>
        </div>
    </div>
</div>